{% extends "base.html" %}

{% block title %}マイアカウント - 大喜利アプリ{% endblock %}

{% block content %}
<h1>👤 マイアカウント</h1>

<div class="card">
    <div style="display: flex; gap: 30px; align-items: start; flex-wrap: wrap;">
        <div style="text-align: center;">
            <img src="{{ url_for('static', filename='uploads/' + user['image']) }}" 
                 alt="プロフィール画像" 
                 style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 4px solid #667eea;"
                 onerror="this.src='{{ url_for('static', filename='uploads/default.png') }}'">
        </div>
        
        <div style="flex: 1;">
            <h2 style="margin-bottom: 10px;">{{ user['username'] }}</h2>
            <p style="color: #666; margin-bottom: 20px;">{{ user['bio'] or '自己紹介がまだ設定されていません' }}</p>
            
            {% if user['show_stats'] %}
            <div style="display: flex; gap: 20px; margin-bottom: 20px; flex-wrap: wrap;">
                <div>
                    <strong style="color: #667eea;">総試合数:</strong> {{ user['battles'] }}
                </div>
                <div>
                    <strong style="color: #28a745;">勝利回数:</strong> {{ user['wins'] }}
                </div>
                <div>
                    <strong style="color: #ffc107;">獲得ポイント:</strong> {{ user['total_points'] }}
                </div>
            </div>
            {% endif %}
            
            {% if user['best_answer'] %}
            <div style="background: #f0f0f0; padding: 15px; border-radius: 10px; margin-top: 15px;">
                <strong style="color: #764ba2;">ベスト回答</strong>
                <p style="margin-top: 5px;"><strong>お題:</strong> {{ user['best_answer_topic'] }}</p>
                <p style="margin-top: 5px; font-size: 1.1em;">{{ user['best_answer'] }}</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<div class="card">
    <h2>プロフィール編集</h2>
    <form method="POST" action="{{ url_for('edit_account') }}" enctype="multipart/form-data">
        <label>プロフィール画像</label>
        <input type="file" name="image" accept="image/*" style="margin-bottom: 15px;">
        
        <label>自己紹介</label>
        <textarea name="bio" rows="4" placeholder="自己紹介を入力してください">{{ user['bio'] }}</textarea>
        
        <label>
            <input type="checkbox" name="show_stats" {% if user['show_stats'] %}checked{% endif %}>
            戦績を公開する
        </label>
        
        <h3 style="margin-top: 20px; color: #764ba2;">ベスト回答設定</h3>
        
        <label>お題</label>
        <input type="text" name="best_answer_topic" value="{{ user['best_answer_topic'] }}" placeholder="お題を入力">
        
        <label>回答</label>
        <textarea name="best_answer" rows="3" placeholder="ベスト回答を入力">{{ user['best_answer'] }}</textarea>
        
        <button type="submit" class="btn">保存</button>
    </form>
</div>
{% endblock %}